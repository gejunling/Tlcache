<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd
		">

	<bean id="jedisPoolConfig" class="redis.clients.jedis.JedisPoolConfig">
		<property name="maxTotal" value="500" />
		<property name="maxIdle" value="100" />
		<property name="minIdle" value="10" />
		<property name="maxWaitMillis" value="2000" />
		<property name="testOnBorrow" value="true" />
	</bean>
	
	
	<bean id="redisClusterConnectionFactory"
		  class="com.tl.flasher.spring.RedisClusterConnectionVHFactory">
		<property name="hostPort" value="10.58.47.100:2181" />
		<property name="business" value="hotel" />
		<!-- 注入业务名称 -->
		<property name="jedisPoolConfig" ref="jedisPoolConfig" />
	</bean>

	<bean id="redisCluster"
		  class="com.tl.flasher.impl.RedisClusterImpl">
		<property name="redisClusterConnectionFactory" ref="redisClusterConnectionFactory" />
	</bean>

	<!-- 1-监控拦截器 -->
	<bean id="monitorInterceptor" class="com.tl.flasher.monitor.interceptor.MonitorInterceptor" />
	<!-- 2-配置切面 -->
	<!--<aop:config>-->
		<!--<aop:pointcut id="gedisPoint" expression="execution(* cn.com.gome.ztghb.flasherer.impl.*Impl.*(..))"/>-->
		<!--<aop:advisor pointcut-ref="gedisPoint" advice-ref="monitorInterceptor"/>-->
	<!--</aop:config>-->
	<!--  2-配置拦截器代理 -->
	<bean id="autoProxyCreator" class="org.springframework.aop.framework.autoproxy.BeanNameAutoProxyCreator">
		<!-- 设置目标对象 -->
		<property name="beanNames">
			<list>
				<value>redisCluster</value>
			</list>
		</property>
		<!-- 代理对象所使用的拦截器 -->
		<property name="interceptorNames">
			<list>
				<value>monitorInterceptor</value>
			</list>
		</property>
	</bean>
	<!--&lt;!&ndash; 3-设置自动上报任务 &ndash;&gt;-->
	<!--<bean id="monitorService" class="cn.com.gome.ztghb.flasherer.monitor.MonitorService">-->
		<!--<property name="url" value="http://127.0.0.1:8888/test2"/>-->
		<!--<property name="protocol" ref="protocol"/>-->
	<!--</bean>-->
	<!--&lt;!&ndash; 4-设置上报数据协议类型 &ndash;&gt;-->
	<!--<bean id="protocol" class="cn.com.gome.ztghb.flasherer.monitor.protocol.falcon.FalconProtocol">-->
		<!--<property name="endpoint" value="redis-cluster"/>-->
	<!--</bean>-->
	
</beans>

<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd
		">

	<bean id="jedisPoolConfig" class="redis.clients.jedis.JedisPoolConfig">
		<property name="maxTotal" value="500" />
		<property name="maxIdle" value="100" />
		<property name="minIdle" value="10" />
		<property name="maxWaitMillis" value="2000" />
		<property name="testOnBorrow" value="true" />
	</bean>
	<bean id="redisClusterConnectionFactory"
		  class="com.tl.flasher.spring.RedisClusterConnectionFactory">
		<!--<property name="hostPorts">-->
			<!--<set>-->
				<!--<value>10.58.47.100:7010</value>-->
				<!--<value>10.58.47.100:7011</value>-->
				<!--<value>10.58.47.100:7012</value>-->
				<!--<value>10.58.47.101:7010</value>-->
				<!--<value>10.58.47.101:7011</value>-->
				<!--<value>10.58.47.101:7012</value>-->
			<!--</set>-->
		<!--</property>-->
		<!--<property name="hostPort" value="10.58.47.100:7010,10.58.47.100:7011,10.58.47.100:7012,10.58.47.101:7010,10.58.47.101:7011,10.58.47.101:7012" />-->
		<property name="hostPort" value="192.168.0.11:7001,192.168.0.11:7002,192.168.0.12:7001,192.168.0.12:7002,192.168.0.13:7001,192.168.0.13:7002" />
		<property name="jedisPoolConfig" ref="jedisPoolConfig" />
	</bean>
	<bean id="redisCluster"
		  class="com.tl.flasher.impl.RedisClusterImpl">
		<constructor-arg index="0" ref="redisClusterConnectionFactory" />
	</bean>

	<!--<bean id="redisConnectionFactory" claRedisConnectionFactorytory">
		<property name="hostPort" value="10.58.47.100:6379" />
	</bean>
	<bean id="redis" claRedisImplImpl">
		<constructor-arg index="0" ref="redisConnectionFactory" />
	</bean>-->

	<!-- 1-监控拦截器 -->
	<bean id="monitorInterceptor" class="com.tl.flasher.monitor.interceptor.MonitorInterceptor" />
	<!-- 2-配置切面 -->
	<!--<aop:config>-->
		<!--<aop:pointcut id="gedisPoint" expression="execution(* cn.com.gome.ztghb.flasherer.impl.*Impl.*(..))"/>-->
		<!--<aop:advisor pointcut-ref="gedisPoint" advice-ref="monitorInterceptor"/>-->
	<!--</aop:config>-->
	<!--  2-配置拦截器代理 -->
	<bean id="autoProxyCreator" class="org.springframework.aop.framework.autoproxy.BeanNameAutoProxyCreator">
		<!-- 设置目标对象 -->
		<property name="beanNames">
			<list>
				<value>redisCluster</value>
			</list>
		</property>
		<!-- 代理对象所使用的拦截器 -->
		<property name="interceptorNames">
			<list>
				<value>monitorInterceptor</value>
			</list>
		</property>
	</bean>
	<!--&lt;!&ndash; 3-设置自动上报任务 &ndash;&gt;-->
	<!--<bean id="monitorService" class="cn.com.gome.ztghb.flasherer.monitor.MonitorService">-->
		<!--<property name="url" value="http://127.0.0.1:8888/test2"/>-->
		<!--<property name="protocol" ref="protocol"/>-->
	<!--</bean>-->
	<!--&lt;!&ndash; 4-设置上报数据协议类型 &ndash;&gt;-->
	<!--<bean id="protocol" class="cn.com.gome.ztghb.flasherer.monitor.protocol.falcon.FalconProtocol">-->
		<!--<property name="endpoint" value="redis-cluster"/>-->
	<!--</bean>-->

	<!--3-设置自动上报任务 -->
	<bean id="monitorService" class="com.tl.flasher.monitor.MonitorService">
		<property name="url" value="http://127.0.0.1:8085/log"/>
		<property name="protocol" ref="protocol"/>
	</bean>
	<!-- 4-设置上报数据协议类型-->
	<bean id="protocol" class="com.tl.flasher.monitor.protocol.falcon.FalconProtocol">
		<property name="endpoint" value="redis-cluster"/>
	</bean>
</beans>
